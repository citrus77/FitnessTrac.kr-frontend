(this["webpackJsonpfitness-trackr"]=this["webpackJsonpfitness-trackr"]||[]).push([[0],{32:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(18),s=n.n(c),a=n(8),i=n(3),o=n.n(i),l=n(6),u=n(4),j=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r,c,s,a,i,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,c=t.token,s=t.body,e.prev=1,a={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},c&&(a.headers.Authorization="Bearer ".concat(c)),e.next=6,fetch("".concat("https://fitnesstrac-kr.herokuapp.com/api").concat(n),a);case 6:return i=e.sent,e.next=9,i.json();case 9:if(!(l=e.sent).error){e.next=12;break}return e.abrupt("return",{error:l.error});case 12:return e.abrupt("return",l);case 15:e.prev=15,e.t0=e.catch(1),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),b=n(2),d=n(0),h=function(e){var t=e.activities,n=e.fetchActivities,c=localStorage.getItem("token"),s=Object(r.useState)(""),a=Object(u.a)(s,2),i=a[0],h=a[1],p=Object(r.useState)(""),O=Object(u.a)(p,2),x=O[0],m=O[1],f=Object(b.e)(),v=function(){var e=Object(l.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,j({url:"/activities",method:"POST",body:{name:i,description:x},token:c});case 4:if(!(r=e.sent)){e.next=11;break}return e.next=8,n();case 8:h(""),m(""),f.push("/activities");case 11:return e.abrupt("return",r);case 14:e.prev=14,e.t0=e.catch(1),console.error(e.t0);case 17:case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[c?Object(d.jsx)("div",{className:"form-container",children:Object(d.jsxs)("form",{onSubmit:v,children:[Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Name: "}),Object(d.jsx)("input",{type:"text",placeholder:"enter activity name",value:i,onChange:function(e){h(e.target.value)}})]}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Description: "}),Object(d.jsx)("input",{type:"text",value:x,placeholder:"enter activity description",onChange:function(e){m(e.target.value)}})]}),Object(d.jsx)("button",{type:"submit",children:"Add activity"})]})}):null,t?Object(d.jsxs)("div",{className:"activities",children:[Object(d.jsx)("span",{children:"Activities:"}),t.map((function(e){return Object(d.jsx)(g,{activity:e},e.id)}))]}):"Loading..."]})},p=n(12),O=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)([]),i=Object(u.a)(s,2),O=i[0],g=i[1],k=Object(r.useState)(""),y=Object(u.a)(k,2),N=y[0],w=y[1],S=Object(r.useState)(""),C=Object(u.a)(S,2),R=C[0],P=C[1],A=Object(r.useState)([]),F=Object(u.a)(A,2),T=F[0],D=F[1],I=Object(b.e)(),L=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j({url:"/routines"});case 3:return(t=e.sent)&&c(t),e.abrupt("return");case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("token"),n=localStorage.getItem("username"),e.prev=2,!n){e.next=9;break}return e.next=6,j({url:"/users/".concat(n,"/routines"),token:"".concat(t)});case 6:(r=e.sent)&&D(r);case 9:return e.abrupt("return");case 13:e.prev=13,e.t0=e.catch(2),console.error(e.t0);case 16:case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j({url:"/activities"});case 3:return(t=e.sent)&&g(t),e.abrupt("return");case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),G={activities:O,setActivities:g,publicRoutines:n,setPublicRoutines:c,token:N,setToken:w,userName:R,setUserName:P,userRoutines:T,setUserRoutines:D,fetchActivities:E,fetchPublicRoutines:L,fetchUserRoutines:U};return Object(r.useEffect)((function(){try{E(),L(),U(),N&&U()}catch(e){console.error(e)}}),[N]),Object(r.useEffect)((function(){var e=localStorage.getItem("token");e&&w(e)})),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("header",{className:"site-header",children:[Object(d.jsx)("div",{className:"logo",children:"Fitness Trac.kr"}),Object(d.jsxs)("div",{className:"link-bar",children:[Object(d.jsx)(a.b,{to:"/",className:"nav-link",children:"Home"}),Object(d.jsx)(a.b,{to:"/routines",className:"nav-link",children:"Routines"}),N?Object(d.jsx)(a.b,{to:"/user/routines",className:"nav-link",children:"My Routines"}):null,Object(d.jsx)(a.b,{to:"/activities",className:"nav-link",children:"Activities"}),N?Object(d.jsx)("button",{className:"logout",onClick:function(){localStorage.removeItem("token"),localStorage.removeItem("username"),P(""),w(""),D([]),I.push("/")},children:"Log out"}):Object(d.jsx)(a.b,{to:"/account/login",className:"nav-link",children:"Sign in"})]})]}),Object(d.jsxs)("main",{children:[Object(d.jsx)(b.a,{exact:!0,path:"/",children:Object(d.jsx)(x,Object(p.a)({},G))}),Object(d.jsx)(b.a,{exact:!0,path:"/routines",children:Object(d.jsx)(v,Object(p.a)({},G))}),Object(d.jsx)(b.a,{exact:!0,path:"/activities",children:Object(d.jsx)(h,Object(p.a)({},G))}),Object(d.jsx)(b.a,{exact:!0,path:"/user/routines",children:Object(d.jsx)(f,Object(p.a)({},G))}),Object(d.jsx)(b.a,{exact:!0,path:"/account/:method",children:Object(d.jsx)(m,Object(p.a)({},G))})]})]})},x=function(){return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("div",{children:"Welcome to FitnessTrac.kr"})})},m=function(e){var t=e.fetchUserRoutines,n=e.setToken,c=e.setUserName,s=(e.setUserRoutines,Object(r.useState)("")),i=Object(u.a)(s,2),h=i[0],p=i[1],O=Object(r.useState)(""),x=Object(u.a)(O,2),m=x[0],f=x[1],v=Object(r.useState)(""),g=Object(u.a)(v,2),k=g[0],y=g[1],N=Object(r.useState)(""),w=Object(u.a)(N,2),S=w[0],C=w[1],R=Object(b.f)(),P=Object(b.e)();return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:"form-container",children:[Object(d.jsx)("div",{className:"login-header",children:"register"===R.method?Object(d.jsx)("h3",{className:"header",children:"Register a new account"}):Object(d.jsx)("h3",{className:"header",children:"Login to your account"})}),Object(d.jsxs)("form",{className:"login-form",onSubmit:function(){var e=Object(l.a)(o.a.mark((function e(r){var s,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,j({url:"/users/".concat(R.method),method:"POST",body:{username:h,password:m}});case 4:if((s=e.sent).error&&C(s.error),!s.token){e.next=22;break}return a=s.token,n(a),localStorage.setItem("token",a),e.next=13,j({url:"/users/me",token:a});case 13:if(!(i=e.sent)){e.next=22;break}return c(i.username),localStorage.setItem("username",i.username),e.next=19,t();case 19:p(""),f(""),P.push("/user/routines");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),console.error(e.t0);case 27:case 28:case"end":return e.stop()}}),e,null,[[1,24]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(d.jsxs)("fieldset",{className:"input-fieldset",children:[Object(d.jsx)("label",{children:"User name"}),Object(d.jsx)("input",{className:"input-field",type:"text",name:"Login Name",placeholder:"enter your user name",onChange:function(e){return p(e.target.value)}})]}),Object(d.jsxs)("fieldset",{className:"input-fieldset",children:[Object(d.jsx)("label",{children:"Password"}),Object(d.jsx)("input",{className:"input-field",type:"password",name:"Password",placeholder:"password (min length 6 chars)",onChange:function(e){return f(e.target.value)}})]}),"register"===R.method?Object(d.jsxs)("fieldset",{className:"input-fieldset",children:[Object(d.jsx)("label",{children:"Verify Password"}),Object(d.jsx)("input",{className:"input-field",type:"password",name:"Verify Password",placeholder:"re-enter your password",onChange:function(e){return y(e.target.value)}})]}):"","register"===R.method?Object(d.jsx)("button",{className:"login-button",type:"submit",disabled:!m||!h||m.length<8||m!==k,children:"Register"}):Object(d.jsx)("button",{className:"login-button",type:"submit",disabled:!m||!h||m.length<8,children:"Login"}),"register"===R.method&&m!==k&&Object(d.jsx)("span",{className:"password-alert",children:"Passwords must match!"}),"register"===R.method&&m.length<8&&Object(d.jsx)("span",{className:"password-alert",children:"Passwords must contain at least 8 characters!"}),S?Object(d.jsx)("span",{children:S}):null,"register"===R.method?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("span",{children:"Already have an account yet? "}),Object(d.jsx)(a.b,{to:"/account/login",className:"login-link",children:"Click here to log in!"})]}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("span",{children:"Already have an account yet? "}),Object(d.jsx)(a.b,{to:"/account/register",className:"login-link",children:"Click here to register!"})]})]})]})})},f=function(e){var t=e.fetchPublicRoutines,n=e.fetchUserRoutines,c=e.userRoutines,s=Object(r.useState)(""),a=Object(u.a)(s,2),i=a[0],h=a[1],p=Object(r.useState)(""),O=Object(u.a)(p,2),x=O[0],m=O[1],f=Object(r.useState)(!1),v=Object(u.a)(f,2),g=v[0],y=v[1],N=Object(r.useState)(""),w=Object(u.a)(N,2),S=w[0],C=w[1],R=localStorage.getItem("token"),P=Object(b.e)(),A=function(){var e=Object(l.a)(o.a.mark((function e(r){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,j({url:"/routines",method:"POST",body:{name:i,goal:x,isPublic:g},token:R});case 4:if((c=e.sent).error&&C(c.error),!c){e.next=18;break}return e.next=10,j({url:"/routines",token:R});case 10:return h(""),m(""),y(!1),e.next=15,t();case 15:return e.next=17,n();case 17:P.push("/user/routines");case 18:return e.abrupt("return",c);case 22:e.prev=22,e.t0=e.catch(1),console.error(e.t0);case 25:case 26:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(l.a)(o.a.mark((function e(r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j({url:"/routines/".concat(r),method:"DELETE",token:R});case 3:return e.next=5,j({url:"/routines",token:R});case 5:n(),t(),P.push("/user/routines"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"form-container",children:Object(d.jsxs)("form",{onSubmit:A,children:[Object(d.jsx)("label",{children:"Create a new routine:"}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Name: "}),Object(d.jsx)("input",{type:"text",placeholder:" enter name",onChange:function(e){h(e.target.value)}})]}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Goal: "}),Object(d.jsx)("input",{type:"text",placeholder:" enter goal",onChange:function(e){m(e.target.value)}})]}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Public: "}),Object(d.jsxs)("select",{placeholder:"no",onChange:function(e){y(e.target.value)},children:[Object(d.jsx)("option",{value:"false",children:"NO"}),Object(d.jsx)("option",{value:"true",children:"YES"})]})]}),Object(d.jsx)("button",{type:"submit",children:"Create Routine"}),S?Object(d.jsx)("div",{className:"password-alert",children:S}):null]})}),c.length>0?Object(d.jsxs)("div",{className:"routines",children:[Object(d.jsx)("span",{children:"Routines:"}),c.map((function(e){return Object(d.jsxs)(k,{routine:e,children:[Object(d.jsx)("button",{onClick:function(){return F(e.id)},children:"Delete routine"}),Object(d.jsxs)("div",{children:[Object(d.jsxs)("form",{onSubmit:(r=e.id,function(){var e=Object(l.a)(o.a.mark((function e(c){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),e.prev=1,e.next=4,j({url:"routines/".concat(r),method:"PATCH",body:{name:i,goal:x},token:R});case 4:if((s=e.sent).error&&C(s.error),!s){e.next=19;break}return console.log(s),e.next=11,j({url:"/routines",token:R});case 11:return h(""),m(""),y(!1),e.next=16,t();case 16:return e.next=18,n();case 18:P.push("/user/routines");case 19:return e.abrupt("return",s);case 23:e.prev=23,e.t0=e.catch(1),console.error(e.t0);case 26:case 27:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(t){return e.apply(this,arguments)}}()),children:[Object(d.jsx)("label",{children:"Edit routine:"}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Change name: "}),Object(d.jsx)("input",{type:"text",value:i,placeholder:e.name,onChange:function(e){return h(e.target.value)}})]}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("label",{children:"Change goal: "}),Object(d.jsx)("input",{type:"text",value:x,placeholder:e.goal,onChange:function(e){return m(e.target.value)}})]})]}),Object(d.jsx)("button",{type:"submit",children:"Submit changes"})]})]},e.id);var r}))]}):null]})},v=function(e){var t=e.publicRoutines;return t?Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:"routines",children:[Object(d.jsx)("span",{children:"Routines:"}),t.map((function(e){return Object(d.jsx)(k,{routine:e},e.id)}))]})}):"Loading..."},g=function(e){var t=e.children,n=e.activity;return n?Object(d.jsxs)("div",{className:"activity-single",children:[Object(d.jsxs)("span",{children:["Name: ",n.name]}),Object(d.jsxs)("span",{children:["Description: ",n.description]}),t]}):"Loading..."},k=function(e){var t=e.children,n=e.routine;return n?Object(d.jsxs)("div",{className:"routine-single",children:[Object(d.jsx)("span",{children:Object(d.jsx)("h3",{children:n.name})}),Object(d.jsx)("span",{children:Object(d.jsxs)("h3",{className:"creator-name",children:["created by ",n.creatorName]})}),Object(d.jsxs)("span",{children:["Goal: ",n.goal]}),Object(d.jsxs)("span",{children:["Public: ",n.isPublic?"yes":"no"]}),t,n.activities.length>0&&Object(d.jsxs)("div",{className:"activities",children:[Object(d.jsx)("span",{children:"Activities:"}),Object(d.jsx)("ul",{className:"activities-list",children:n.activities.map((function(e){return Object(d.jsx)("li",{className:"activity-single",children:Object(d.jsx)(g,{activity:e,children:Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("span",{children:["Repetition: ",e.count," times"]}),Object(d.jsxs)("span",{children:["Duration: ",e.duration," minutes"]})]})})},e.id)}))})]})]}):"Loading..."};s.a.render(Object(d.jsx)(a.a,{children:Object(d.jsx)(O,{})}),document.querySelector("#app"))}},[[32,1,2]]]);
//# sourceMappingURL=main.6691b8ca.chunk.js.map